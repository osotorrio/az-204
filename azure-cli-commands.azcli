### CLI

az login

# Set CLI Defaults
az configure --defaults group=learn-682491ea-0eec-4c67-993c-833f6c429466 location=westus2

#------------------------------------------------------------------------------------------------------------------------------------------------------

### SUBSCRIPTION

az account show -output table

#------------------------------------------------------------------------------------------------------------------------------------------------------

### RESOURCE GROUP

# Create resource group
az group create \
  --name {name of your resource group} \
  --location "{location}"

# LIST RESOURCE GROUPS
az group list -o table

az deployment group create -n deployment-name-2021 --template-file azuredeploy.json
#------------------------------------------------------------------------------------------------------------------------------------------------------

### STORAGE ACCOUNT

# Create Storage Account
az storage account create 
    --name oscarlearning2021 
    -g learn-a0e633bf-050a-4799-aa30-5a99a950dc62 
    --kind StorageV2 
    --sku Standard_LRS 
    -l westeurope

# Get Storage Account connection string
az storage account show-connection-string 
    --name oscarlearning2021 
    --resource-group learn-a0e633bf-050a-4799-aa30-5a99a950dc62

# List Storage Account access keys
az storage account keys list --account-name storageaccountname2022

# Create a container in Storage Account
az storage container create 
    --name messages 
    --connection-string "<connection string here>"
    
#------------------------------------------------------------------------------------------------------------------------------------------------------

### SERVICE BUS

# Get Service Bus connection string
az servicebus namespace authorization-rule keys list 
    --resource-group test-learning-stuff 
    --name RootManageSharedAccessKey 
    --query primaryConnectionString 
    --output tsv 
    --namespace-name servicebus-learn-paths-salesteamapp

# List Service Bus Queue Messages
az servicebus queue show
    --resource-group test-learning-stuff
    --name salesteamapp
    --query messageCount
    --namespace-name servicebus-learn-paths-salesteamapp

# List Service Bus topic subscriptions
az servicebus topic subscription show
    --resource-group test-learning-stuff
    --namespace-name servicebus-learn-paths-salesteamapp
    --topic-name salesperformancemessages
    --name EuropeAndAfrica
    --query subs-europe-africa

#------------------------------------------------------------------------------------------------------------------------------------------------------

### QUEUE STORAGE

# Peek messsage from Queue Storage
az storage message peek 
    --queue-name testqueue 
    --connection-string "DefaultEndpointsProtocol=https;EndpointSuffix=core.windows.net;AccountName=oscarlearning2021;AccountKey=SomeCrazykeyValueHere"

#------------------------------------------------------------------------------------------------------------------------------------------------------

### EVENT HUBS

# Create Event Hubs namespace
az eventhubs namespace create --name testingEventHub2021

# Get Event Hubs connection string
az eventhubs namespace authorization-rule keys list 
    --name RootManageSharedAccessKey 
    --namespace-name eventhubsnamespace2021

# Create an Event Hub
az eventhubs eventhub create 
    --name eventhubname2021 
    --namespace-name eventhubsnamespace2021

# Get Event Hub details
az eventhubs eventhub show 
    --namespace-name eventhubsnamespace2021 
    --name eventhubname2021

#------------------------------------------------------------------------------------------------------------------------------------------------------

### EVENT GRID

# Create Event Grid subscription
az eventgrid event-subscription create 
    --name queue-subscription 
    --source-resource-id /subscriptions/20c6eec9-2d80-4700-b0f6-4fde579a8783/resourceGroups/demogrp1/providers/Microsoft.Storage/storageAccounts/demostore4000 
    --endpoint-type servicebusqueue 
    --endpoint /subscriptions/20c6eec9-2d80-4700-b0f6-4fde579a8783/resourceGroups/demogrp1/providers/Microsoft.ServiceBus/namespaces/appnamespace4000/queues/appqueue